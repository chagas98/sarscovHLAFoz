) +
scale_y_discrete(drop = FALSE)
fig6 <- ggplot(FC_loss_all)+
ggnewscale::new_scale_colour()+
geom_point(aes(x = fold_change, y = factor(variant_lineage, detection_sorted),
colour = alleles, shape=factor(length)),
size = 7,
fill = NA,
stroke=1) +
geom_text(aes(x=fold_change, y= factor(variant_lineage, detection_sorted), label=variant_protein_sorted, fontface='plain', family='sans', colour=alleles)),
geom_text(aes(x=fold_change, y= factor(variant_lineage, detection_sorted), label=variant_protein_sorted, fontface='plain', family='sans', colour=alleles),
fig6 <- ggplot(FC_loss_all)+
ggnewscale::new_scale_colour()+
geom_point(aes(x = fold_change, y = factor(variant_lineage, detection_sorted),
colour = alleles, shape=factor(length)),
size = 7,
fill = NA,
stroke=1) +
geom_text(aes(x=fold_change, y= factor(variant_lineage, detection_sorted), label=variant_protein_sorted, fontface='plain', family='sans', colour=alleles),
size=3)+
labs(x=expression(phantom()*Log[2]*FC),
y = '',
shape="K-mers") +
coord_cartesian(clip='off') +
theme(
plot.title = element_text(size=14, face= "bold", colour= "black" ),
axis.title.x = element_text(size=14, face="bold", colour = "black"),
axis.title.y = element_text(size=14, face="bold", colour = "black"),
axis.text.x = element_text(size=15, face="bold", colour = "black"),
axis.text.y = element_text(size=10, face="bold", colour = "white"),
legend.title = element_text(face = "bold", size=13),
legend.text =  element_text(size=12),
legend.title.align = 0.4,
panel.background = element_rect(fill = "white"),
panel.grid = element_line(color = "grey70")
) +
scale_colour_manual('Alelos', values = getPalette_alleles(colourCount_alleles)) +
scale_shape_manual(values = c(0, 1, 2, 5)) +
annotation_custom(
grob=muh_grob, ymin = 0, ymax = 1, xmin = -0.55, xmax=0.25
) +
scale_y_discrete(drop = FALSE)
fig6 <- ggplot(FC_loss_all)+
fig6 <- ggplot(FC_loss_all)+
ggnewscale::new_scale_colour()+
geom_point(aes(x = fold_change, y = factor(variant_lineage, detection_sorted),
colour = alleles, shape=factor(length)),
size = 7,
fill = NA,
stroke=1) +
geom_text(aes(x=fold_change, y= factor(variant_lineage, detection_sorted), label=variant_protein_sorted, fontface='plain', family='sans', colour=alleles),
size=3)+
labs(x=expression(phantom()*Log[2]*FC),
y = '',
shape="K-mers") +
coord_cartesian(clip='off') +
theme(
plot.title = element_text(size=14, face= "bold", colour= "black" ),
axis.title.x = element_text(size=14, face="bold", colour = "black"),
axis.title.y = element_text(size=14, face="bold", colour = "black"),
axis.text.x = element_text(size=15, face="bold", colour = "black"),
axis.text.y = element_text(size=10, face="bold", colour = "white"),
legend.title = element_text(face = "bold", size=13),
legend.text =  element_text(size=12),
legend.title.align = 0.4,
panel.background = element_rect(fill = "white"),
panel.grid = element_line(color = "grey70")
) +
scale_colour_manual('Alelos', values = getPalette_alleles(colourCount_alleles)) +
scale_shape_manual(values = c(0, 1, 2, 5)) +
annotation_custom(
grob=muh_grob, ymin = 0, ymax = 1, xmin = -0.55, xmax=0.25
) +
scale_y_discrete(drop = FALSE)
fig6
fig6 <- ggplot(FC_loss_all)+
ggnewscale::new_scale_colour()+
geom_point(aes(x = fold_change, y = factor(variant_lineage, detection_sorted),
colour = alleles, shape=factor(length)),
size = 7,
fill = NA,
stroke=1) +
geom_text(aes(x=fold_change, y= factor(variant_lineage, detection_sorted), label=variant_protein_sorted, fontface='plain', family='sans'),
size=3)+
labs(x=expression(phantom()*Log[2]*FC),
y = '',
shape="K-mers") +
coord_cartesian(clip='off') +
theme(
plot.title = element_text(size=14, face= "bold", colour= "black" ),
axis.title.x = element_text(size=14, face="bold", colour = "black"),
axis.title.y = element_text(size=14, face="bold", colour = "black"),
axis.text.x = element_text(size=15, face="bold", colour = "black"),
axis.text.y = element_text(size=10, face="bold", colour = "white"),
legend.title = element_text(face = "bold", size=13),
legend.text =  element_text(size=12),
legend.title.align = 0.4,
panel.background = element_rect(fill = "white"),
panel.grid = element_line(color = "grey70")
) +
scale_colour_manual('Alelos', values = getPalette_alleles(colourCount_alleles)) +
scale_shape_manual(values = c(0, 1, 2, 5)) +
annotation_custom(
grob=muh_grob, ymin = 0, ymax = 1, xmin = -0.55, xmax=0.25
) +
scale_y_discrete(drop = FALSE)
fig6
fig6 <- ggplot(FC_loss_all)+
ggnewscale::new_scale_colour()+
geom_point(aes(x = fold_change, y = factor(variant_lineage, detection_sorted),
colour = alleles, shape=factor(length)),
size = 7,
fill = NA,
stroke=1) +
geom_text(aes(x=fold_change, y= factor(variant_lineage, detection_sorted), label=variant_protein_sorted, fontface='plain', family='sans'),
size=4)+
labs(x=expression(phantom()*Log[2]*FC),
y = '',
shape="K-mers") +
coord_cartesian(clip='off') +
theme(
plot.title = element_text(size=14, face= "bold", colour= "black" ),
axis.title.x = element_text(size=14, face="bold", colour = "black"),
axis.title.y = element_text(size=14, face="bold", colour = "black"),
axis.text.x = element_text(size=15, face="bold", colour = "black"),
axis.text.y = element_text(size=10, face="bold", colour = "white"),
legend.title = element_text(face = "bold", size=13),
legend.text =  element_text(size=12),
legend.title.align = 0.4,
panel.background = element_rect(fill = "white"),
panel.grid = element_line(color = "grey70")
) +
scale_colour_manual('Alelos', values = getPalette_alleles(colourCount_alleles)) +
scale_shape_manual(values = c(0, 1, 2, 5)) +
annotation_custom(
grob=muh_grob, ymin = 0, ymax = 1, xmin = -0.55, xmax=0.25
) +
scale_y_discrete(drop = FALSE)
fig6
ggsave('Fig6.png', fig6, height = 30, width =27, scale = 1,  units = "cm")
fig6 <- ggplot(FC_loss_all)+
ggnewscale::new_scale_colour()+
geom_point(aes(x = fold_change, y = factor(variant_lineage, detection_sorted),
colour = alleles, shape=factor(length)),
size = 8,
fill = NA,
stroke=1) +
geom_text(aes(x=fold_change, y= factor(variant_lineage, detection_sorted), label=variant_protein_sorted, fontface='plain', family='sans'),
size=4)+
labs(x=expression(phantom()*Log[2]*FC),
y = '',
shape="K-mers") +
coord_cartesian(clip='off') +
theme(
plot.title = element_text(size=14, face= "bold", colour= "black" ),
axis.title.x = element_text(size=14, face="bold", colour = "black"),
axis.title.y = element_text(size=14, face="bold", colour = "black"),
axis.text.x = element_text(size=15, face="bold", colour = "black"),
axis.text.y = element_text(size=10, face="bold", colour = "white"),
legend.title = element_text(face = "bold", size=13),
legend.text =  element_text(size=12),
legend.title.align = 0.4,
panel.background = element_rect(fill = "white"),
panel.grid = element_line(color = "grey70")
) +
scale_colour_manual('Alelos', values = getPalette_alleles(colourCount_alleles)) +
scale_shape_manual(values = c(0, 1, 2, 5)) +
annotation_custom(
grob=muh_grob, ymin = 0, ymax = 1, xmin = -0.55, xmax=0.25
) +
scale_y_discrete(drop = FALSE)
ggsave('Fig6.png', fig6, height = 35, width =27, scale = 1,  units = "cm")
fig6 <- ggplot(FC_loss_all)+
ggnewscale::new_scale_colour()+
geom_point(aes(x = fold_change, y = factor(variant_lineage, detection_sorted),
colour = alleles, shape=factor(length)),
size = 8,
fill = NA,
stroke=1) +
geom_text(aes(x=fold_change, y= 10, label=variant_protein_sorted, fontface='plain', family='sans'),
size=4)+
labs(x=expression(phantom()*Log[2]*FC),
y = '',
shape="K-mers") +
coord_cartesian(clip='off') +
theme(
plot.title = element_text(size=14, face= "bold", colour= "black" ),
axis.title.x = element_text(size=14, face="bold", colour = "black"),
axis.title.y = element_text(size=14, face="bold", colour = "black"),
axis.text.x = element_text(size=15, face="bold", colour = "black"),
axis.text.y = element_text(size=10, face="bold", colour = "white"),
legend.title = element_text(face = "bold", size=13),
legend.text =  element_text(size=12),
legend.title.align = 0.4,
panel.background = element_rect(fill = "white"),
panel.grid = element_line(color = "grey70")
) +
scale_colour_manual('Alelos', values = getPalette_alleles(colourCount_alleles)) +
scale_shape_manual(values = c(0, 1, 2, 5)) +
annotation_custom(
grob=muh_grob, ymin = 0, ymax = 1, xmin = -0.55, xmax=0.25
) +
scale_y_discrete(drop = FALSE)
fig6
fig6 <- ggplot(FC_loss_all)+
ggnewscale::new_scale_colour()+
geom_point(aes(x = fold_change, y = factor(variant_lineage, detection_sorted),
colour = alleles, shape=factor(length)),
size = 8,
fill = NA,
stroke=1) +
geom_text(data=distinct(FC_loss_all, variant_protein_sorted), aes(x=fold_change, y= 10, label=variant_protein_sorted, fontface='plain', family='sans'),
size=4)+
labs(x=expression(phantom()*Log[2]*FC),
y = '',
shape="K-mers") +
coord_cartesian(clip='off') +
theme(
plot.title = element_text(size=14, face= "bold", colour= "black" ),
axis.title.x = element_text(size=14, face="bold", colour = "black"),
axis.title.y = element_text(size=14, face="bold", colour = "black"),
axis.text.x = element_text(size=15, face="bold", colour = "black"),
axis.text.y = element_text(size=10, face="bold", colour = "white"),
legend.title = element_text(face = "bold", size=13),
legend.text =  element_text(size=12),
legend.title.align = 0.4,
panel.background = element_rect(fill = "white"),
panel.grid = element_line(color = "grey70")
) +
scale_colour_manual('Alelos', values = getPalette_alleles(colourCount_alleles)) +
scale_shape_manual(values = c(0, 1, 2, 5)) +
annotation_custom(
grob=muh_grob, ymin = 0, ymax = 1, xmin = -0.55, xmax=0.25
) +
scale_y_discrete(drop = FALSE)
fig6
distinct(FC_loss_all, variant_protein_sorted)
distinct(FC_loss_all, variant_protein_sorted, .keep_all = TRUE)
fig6 <- ggplot(FC_loss_all)+
ggnewscale::new_scale_colour()+
geom_point(aes(x = fold_change, y = factor(variant_lineage, detection_sorted),
colour = alleles, shape=factor(length)),
size = 8,
fill = NA,
stroke=1) +
geom_text(data=distinct(FC_loss_all, variant_protein_sorted,  .keep_all = TRUE), aes(x=fold_change, y= 10, label=variant_protein_sorted, fontface='plain', family='sans'),
size=4)+
labs(x=expression(phantom()*Log[2]*FC),
y = '',
shape="K-mers") +
coord_cartesian(clip='off') +
theme(
plot.title = element_text(size=14, face= "bold", colour= "black" ),
axis.title.x = element_text(size=14, face="bold", colour = "black"),
axis.title.y = element_text(size=14, face="bold", colour = "black"),
axis.text.x = element_text(size=15, face="bold", colour = "black"),
axis.text.y = element_text(size=10, face="bold", colour = "white"),
legend.title = element_text(face = "bold", size=13),
legend.text =  element_text(size=12),
legend.title.align = 0.4,
panel.background = element_rect(fill = "white"),
panel.grid = element_line(color = "grey70")
) +
scale_colour_manual('Alelos', values = getPalette_alleles(colourCount_alleles)) +
scale_shape_manual(values = c(0, 1, 2, 5)) +
annotation_custom(
grob=muh_grob, ymin = 0, ymax = 1, xmin = -0.55, xmax=0.25
) +
scale_y_discrete(drop = FALSE)
fig6
fig6 <- ggplot(FC_loss_all)+
ggnewscale::new_scale_colour()+
geom_point(aes(x = fold_change, y = factor(variant_lineage, detection_sorted),
colour = alleles, shape=factor(length)),
size = 8,
fill = NA,
stroke=1) +
geom_text_repel(data=distinct(FC_loss_all, variant_protein_sorted,  .keep_all = TRUE), aes(x=fold_change, y= 10, label=variant_protein_sorted, fontface='plain', family='sans'),
size=4)+
labs(x=expression(phantom()*Log[2]*FC),
y = '',
shape="K-mers") +
coord_cartesian(clip='off') +
theme(
plot.title = element_text(size=14, face= "bold", colour= "black" ),
axis.title.x = element_text(size=14, face="bold", colour = "black"),
axis.title.y = element_text(size=14, face="bold", colour = "black"),
axis.text.x = element_text(size=15, face="bold", colour = "black"),
axis.text.y = element_text(size=10, face="bold", colour = "white"),
legend.title = element_text(face = "bold", size=13),
legend.text =  element_text(size=12),
legend.title.align = 0.4,
panel.background = element_rect(fill = "white"),
panel.grid = element_line(color = "grey70")
) +
scale_colour_manual('Alelos', values = getPalette_alleles(colourCount_alleles)) +
scale_shape_manual(values = c(0, 1, 2, 5)) +
annotation_custom(
grob=muh_grob, ymin = 0, ymax = 1, xmin = -0.55, xmax=0.25
) +
scale_y_discrete(drop = FALSE)
fig6
fig6 <- ggplot(FC_loss_all)+
ggnewscale::new_scale_colour()+
geom_point(aes(x = fold_change, y = factor(variant_lineage, detection_sorted),
colour = alleles, shape=factor(length)),
size = 8,
fill = NA,
stroke=1) +
geom_text_repel(data=distinct(FC_loss_all, variant_protein_sorted,  .keep_all = TRUE), aes(x=fold_change, y= 10, label=variant_protein_sorted, fontface='plain', family='sans'),
size=4,   max.overlaps = Inf,
min.segment.length = 10, seed = 42, point.padding = 3,
max.time = 2, max.iter = 1e5)+
labs(x=expression(phantom()*Log[2]*FC),
y = '',
shape="K-mers") +
coord_cartesian(clip='off') +
theme(
plot.title = element_text(size=14, face= "bold", colour= "black" ),
axis.title.x = element_text(size=14, face="bold", colour = "black"),
axis.title.y = element_text(size=14, face="bold", colour = "black"),
axis.text.x = element_text(size=15, face="bold", colour = "black"),
axis.text.y = element_text(size=10, face="bold", colour = "white"),
legend.title = element_text(face = "bold", size=13),
legend.text =  element_text(size=12),
legend.title.align = 0.4,
panel.background = element_rect(fill = "white"),
panel.grid = element_line(color = "grey70")
) +
scale_colour_manual('Alelos', values = getPalette_alleles(colourCount_alleles)) +
scale_shape_manual(values = c(0, 1, 2, 5)) +
annotation_custom(
grob=muh_grob, ymin = 0, ymax = 1, xmin = -0.55, xmax=0.25
) +
scale_y_discrete(drop = FALSE)
fig6
fig6 <- ggplot(FC_loss_all)+
ggnewscale::new_scale_colour()+
geom_point(aes(x = fold_change, y = factor(variant_lineage, detection_sorted),
colour = alleles, shape=factor(length)),
size = 8,
fill = NA,
stroke=1) +
geom_text_repel(data=distinct(FC_loss_all, variant_protein_sorted,  .keep_all = TRUE), aes(x=fold_change, y= 40, label=variant_protein_sorted, fontface='plain', family='sans'),
size=4,   max.overlaps = Inf,
min.segment.length = 10, seed = 42, point.padding = 3,
max.time = 2, max.iter = 1e5,
direction = "x")+
labs(x=expression(phantom()*Log[2]*FC),
y = '',
shape="K-mers") +
coord_cartesian(clip='off') +
theme(
plot.title = element_text(size=14, face= "bold", colour= "black" ),
axis.title.x = element_text(size=14, face="bold", colour = "black"),
axis.title.y = element_text(size=14, face="bold", colour = "black"),
axis.text.x = element_text(size=15, face="bold", colour = "black"),
axis.text.y = element_text(size=10, face="bold", colour = "white"),
legend.title = element_text(face = "bold", size=13),
legend.text =  element_text(size=12),
legend.title.align = 0.4,
panel.background = element_rect(fill = "white"),
panel.grid = element_line(color = "grey70")
) +
scale_colour_manual('Alelos', values = getPalette_alleles(colourCount_alleles)) +
scale_shape_manual(values = c(0, 1, 2, 5)) +
annotation_custom(
grob=muh_grob, ymin = 0, ymax = 1, xmin = -0.55, xmax=0.25
) +
scale_y_discrete(drop = FALSE)
fig6
ggsave('Fig6.png', fig6, height = 27, width =27, scale = 1,  units = "cm")
ggsave('Fig6.png', fig6, height = 20, width =35, scale = 1,  units = "cm")
fig6 <- ggplot(FC_loss_all)+
ggnewscale::new_scale_colour()+
geom_point(aes(x = fold_change, y = factor(variant_lineage, detection_sorted),
colour = alleles, shape=factor(length)),
size = 4,
fill = NA,
stroke=1) +
geom_text_repel(data=distinct(FC_loss_all, variant_protein_sorted,  .keep_all = TRUE), aes(x=fold_change, y= 35, label=variant_protein_sorted, fontface='plain', family='sans'),
size=3,   max.overlaps = Inf,
min.segment.length = 10, seed = 42, point.padding = 3,
max.time = 2, max.iter = 1e5,
direction = "x")+
labs(x=expression(phantom()*Log[2]*FC),
y = '',
shape="K-mers") +
coord_cartesian(clip='off') +
theme(
plot.title = element_text(size=14, face= "bold", colour= "black" ),
axis.title.x = element_text(size=14, face="bold", colour = "black"),
axis.title.y = element_text(size=14, face="bold", colour = "black"),
axis.text.x = element_text(size=15, face="bold", colour = "black"),
axis.text.y = element_text(size=10, face="bold", colour = "white"),
legend.title = element_text(face = "bold", size=13),
legend.text =  element_text(size=12),
legend.title.align = 0.4,
panel.background = element_rect(fill = "white"),
panel.grid = element_line(color = "grey70")
) +
scale_colour_manual('Alelos', values = getPalette_alleles(colourCount_alleles)) +
scale_shape_manual(values = c(0, 1, 2, 5)) +
annotation_custom(
grob=muh_grob, ymin = 0, ymax = 1, xmin = -0.55, xmax=0.25
) +
scale_y_discrete(drop = FALSE)
fig6
ggsave('Fig6.png', fig6, height = 20, width =35, scale = 1,  units = "cm")
fig6 <- ggplot(FC_loss_all)+
ggnewscale::new_scale_colour()+
geom_point(aes(x = fold_change, y = factor(variant_lineage, detection_sorted),
colour = alleles, shape=factor(length)),
size = 4,
fill = NA,
stroke=1) +
geom_text(data=distinct(FC_loss_all, variant_protein_sorted,  .keep_all = TRUE), aes(x=fold_change, y= 35, label=variant_protein_sorted, fontface='plain', family='sans'),
size=3)+
labs(x=expression(phantom()*Log[2]*FC),
y = '',
shape="K-mers") +
coord_cartesian(clip='off') +
theme(
plot.title = element_text(size=14, face= "bold", colour= "black" ),
axis.title.x = element_text(size=14, face="bold", colour = "black"),
axis.title.y = element_text(size=14, face="bold", colour = "black"),
axis.text.x = element_text(size=15, face="bold", colour = "black"),
axis.text.y = element_text(size=10, face="bold", colour = "white"),
legend.title = element_text(face = "bold", size=13),
legend.text =  element_text(size=12),
legend.title.align = 0.4,
panel.background = element_rect(fill = "white"),
panel.grid = element_line(color = "grey70")
) +
scale_colour_manual('Alelos', values = getPalette_alleles(colourCount_alleles)) +
scale_shape_manual(values = c(0, 1, 2, 5)) +
annotation_custom(
grob=muh_grob, ymin = 0, ymax = 1, xmin = -0.55, xmax=0.25
) +
scale_y_discrete(drop = FALSE)
fig6
ggsave('Fig6.png', fig6, height = 20, width =40, scale = 1,  units = "cm")
fig6 <- ggplot(FC_loss_all)+
ggnewscale::new_scale_colour()+
geom_point(aes(x = fold_change, y = factor(variant_lineage, detection_sorted),
colour = alleles, shape=factor(length)),
size = 4,
fill = NA,
stroke=1) +
geom_text(data=distinct(FC_loss_all, variant_protein_sorted,  .keep_all = TRUE), aes(x=fold_change, y= factor(variant_lineage, detection_sorted), label=variant_protein_sorted, fontface='plain', family='sans'),
size=3,   max.overlaps = Inf,
min.segment.length = 10, seed = 42, point.padding = 3,
max.time = 2, max.iter = 1e5,
direction = "x")+
labs(x=expression(phantom()*Log[2]*FC),
y = '',
shape="K-mers") +
coord_cartesian(clip='off') +
theme(
plot.title = element_text(size=14, face= "bold", colour= "black" ),
axis.title.x = element_text(size=14, face="bold", colour = "black"),
axis.title.y = element_text(size=14, face="bold", colour = "black"),
axis.text.x = element_text(size=15, face="bold", colour = "black"),
axis.text.y = element_text(size=10, face="bold", colour = "white"),
legend.title = element_text(face = "bold", size=13),
legend.text =  element_text(size=12),
legend.title.align = 0.4,
panel.background = element_rect(fill = "white"),
panel.grid = element_line(color = "grey70")
) +
scale_colour_manual('Alelos', values = getPalette_alleles(colourCount_alleles)) +
scale_shape_manual(values = c(0, 1, 2, 5)) +
annotation_custom(
grob=muh_grob, ymin = 0, ymax = 1, xmin = -0.55, xmax=0.25
) +
scale_y_discrete(drop = FALSE)
fig6 <- ggplot(FC_loss_all)+
ggnewscale::new_scale_colour()+
geom_point(aes(x = fold_change, y = factor(variant_lineage, detection_sorted),
colour = alleles, shape=factor(length)),
size = 4,
fill = NA,
stroke=1) +
geom_text_repel(data=distinct(FC_loss_all, variant_protein_sorted,  .keep_all = TRUE), aes(x=fold_change, y= factor(variant_lineage, detection_sorted), label=variant_protein_sorted, fontface='plain', family='sans'),
size=3,   max.overlaps = Inf,
min.segment.length = 10, seed = 42, point.padding = 3,
max.time = 2, max.iter = 1e5,
direction = "x")+
labs(x=expression(phantom()*Log[2]*FC),
y = '',
shape="K-mers") +
coord_cartesian(clip='off') +
theme(
plot.title = element_text(size=14, face= "bold", colour= "black" ),
axis.title.x = element_text(size=14, face="bold", colour = "black"),
axis.title.y = element_text(size=14, face="bold", colour = "black"),
axis.text.x = element_text(size=15, face="bold", colour = "black"),
axis.text.y = element_text(size=10, face="bold", colour = "white"),
legend.title = element_text(face = "bold", size=13),
legend.text =  element_text(size=12),
legend.title.align = 0.4,
panel.background = element_rect(fill = "white"),
panel.grid = element_line(color = "grey70")
) +
scale_colour_manual('Alelos', values = getPalette_alleles(colourCount_alleles)) +
scale_shape_manual(values = c(0, 1, 2, 5)) +
annotation_custom(
grob=muh_grob, ymin = 0, ymax = 1, xmin = -0.55, xmax=0.25
) +
scale_y_discrete(drop = FALSE)
fig6
ggsave('Fig6.png', fig6, height = 20, width =35, scale = 1,  units = "cm")
